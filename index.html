<!DOCTYPE html>
<html>
  <head>
    <title>AI Email Chatbot</title>
    <meta charset="UTF-8" />
    <style>
      body { font-family: Arial; background: #f5f5f5; padding: 40px; }
      #chatBox { max-width: 600px; margin: auto; background: white; border: 1px solid #ccc; border-radius: 8px; padding: 20px; }
      .bot, .user { margin: 6px 0; }
      .bot { text-align: left; }
      .user { text-align: right; }
      #chatInput { width: 80%; padding: 8px; }
      #sendBtn { width: 18%; padding: 8px; }
    </style>
  </head>
  <body>
    <h2 style="text-align:center;">AI Email Chatbot</h2>
    <div id="chatBox">
      <div id="chatLog"></div>
      <input id="chatInput" type="text" placeholder="Type your response..." />
      <button id="sendBtn" onclick="handleChat()">Send</button>
    </div>
    <script>
      let step = 0;
      let emailTopic = "", recipientName = "", recipientEmail = "";
      let chatLog = document.getElementById("chatLog"), chatInput = document.getElementById("chatInput");

      function appendBot(text) { chatLog.innerHTML += `<p class="bot"><strong>Bot:</strong> ${text}</p>`; }
      function appendUser(text) { chatLog.innerHTML += `<p class="user"><strong>You:</strong> ${text}</p>`; }
      window.onload = () => { appendBot("Hi! What should the email be about?"); };

      async function handleChat() {
        let userMessage = chatInput.value.trim(); if (!userMessage) return;
        appendUser(userMessage); chatInput.value = "";

        if (step === 0) { emailTopic = userMessage; appendBot("Who is this email to?"); step++; }
        else if (step === 1) { recipientName = userMessage; appendBot("What is their email address?"); step++; }
        else if (step === 2) {
          recipientEmail = userMessage; appendBot("Generating your email...");
          const response = await fetch("YOUR_WEBHOOK_URL", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt: emailTopic, recipient: recipientName, email: recipientEmail })
          });
          const data = await response.json();
          appendBot("Here's your email draft:");
          appendBot(`<i>${data.emailBody}</i>`);
          appendBot("Would you like me to send it? (yes/no)");
          step++;
        }
        else if (step === 3) {
          if (userMessage.toLowerCase().includes("yes")) { appendBot("âœ… Email sent!"); }
          else { appendBot("Email not sent."); }
        }
      }
    </script>
  </body>
</html>
